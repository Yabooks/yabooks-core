<!DOCTYPE HTML>
<html>
    <head>
        <title>YaBooks</title>
        <base target="main" />
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="/js/axios/axios.min.js"></script>
        <script type="text/javascript" src="/js/vue/vue.js"></script>
    </head>
    <body>
        <main>
            <nav>
                <a href="/login/">
                    Home
                </a>
                <a @click="logout">
                    Logout
                </a>
            </nav>
            <iframe id="main" name="main" src="/login/"></iframe>
        </main>
        <script type="text/javascript">
            new Vue(
            {
                el: "main",

                async mounted()
                {
                    const notifier = new WebSocket(location.protocol.split("http").join("ws") + "//" + location.host + "/api/v1/notifications/ws");
                    notifier.onmessage = async (event) => {
                        console.log(event); // FIXME
                    };
                },

                methods:
                {
                    async logout()
                    {
                        await axios.delete("/api/v1/session");
                        self.location = "/";
                    }
                }
            });
        </script>
    </body>
</html>
